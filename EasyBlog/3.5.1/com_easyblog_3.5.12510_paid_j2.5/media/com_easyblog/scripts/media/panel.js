EasyBlog.module("media/panel",function(e){var t=this;EasyBlog.require().script("media/panel.item").view("media/panel").done(function(){EasyBlog.Controller("Media.Panel",{defaultOptions:{view:{panel:"media/panel"},"{panel}":".panel"}},function(t){return{init:function(){t.setLayout()},setLayout:function(){var e=t.element.height();if(t.currentPanel){var n=e-parseInt(t.currentPanel.element.css("margin-top"))-parseInt(t.currentPanel.element.css("margin-bottom")),r=n-parseInt(t.currentPanel.header().height())-parseInt(t.currentPanel.footer().height());t.currentPanel.element.css("max-height",n),t.currentPanel.body().css("max-height",r)}},getPanelController:function(e){return EasyBlog.Controller.Media.Panel[e]},panels:[],createPanel:function(n){var r=t.view.panel().addClass("panel-type-"+n.meta.type).appendTo(t.element),i=e.uid("panel-"),s=new EasyBlog.Controller.Media.Panel.Item(r,{controller:{id:i,media:t.media,place:t.place,panels:t,item:n}});return t.panels[i]=s,s},removePanel:function(e){var n=t.panels[e];t.deactivatePanel(t.currentPanel!=n,t.currentPanel,function(){delete t.panels[e],n!==undefined&&n.element.remove()})},activatePanel:function(e,n,r){typeof e!="boolean"&&(r=n,n=e,e=!1);var i=t.panels[n];if(i===undefined)return r&&r();if(t.currentPanel===i)return;i.activate(),t.currentPanel||e?t.deactivatePanel(!0,t.currentPanel,function(){return t.currentPanel=i,i.element.addClass("active").css({left:"0px"}),t.setLayout(),r&&r()}):i.element.animate({left:"0px"},{duration:150,easing:"easeInCubic",complete:function(){return t.currentPanel=i,i.element.addClass("active"),t.setLayout(),r&&r()}})},deactivatePanel:function(e,n,r){typeof e!="boolean"&&(r=n,n=e,e=!1);var i;n===undefined?i=t.currentPanel:i=typeof n=="string"?t.panels[n]:n;if(i===undefined)return r&&r();t.currentPanel==i&&(t.currentPanel=undefined);if(!i.element)return r&&r();i.deactivate();if(e)return i.element.removeClass("active").css({left:"-400px"}),r&&r();i.element.removeClass("active").animate({left:"-400px"},{duration:150,easing:"easeInCubic",complete:function(){return r&&r()}})},"{panelSectionHeader} click":function(e){e.parent(".panelSection").toggleClass("active")}}}),t.resolve()})});