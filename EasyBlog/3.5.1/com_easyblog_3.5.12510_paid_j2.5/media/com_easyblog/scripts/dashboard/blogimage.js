EasyBlog.module("dashboard/blogimage",function(e){var t=this;EasyBlog.require().script("dashboard/media","dashboard/media.mini.launcher").done(function(){EasyBlog.Controller("Dashboard.BlogImage",{defaultOptions:{"{dock}":".blogImageDock","{placeHolder}":".blogImagePlaceHolder","{imageData}":".blogImagePlaceHolder input[name=image]","{imageHolder}":".imagePlaceHolder","{image}":".blogImage","{selectBlogImageButton}":".selectBlogImage","{removeBlogImageButton}":".removeBlogImage","{doneBlogImageButton}":".doneBlogImage",resizeUsing:"resizeToFill"}},function(t){return{init:function(){t.dock().hide(),t.selectBlogImageButton().implement(EasyBlog.Controller.Dashboard.Media.Mini.Launcher,{container:t.options["{dock}"],manager:e.extend(t.options.manager,{insert:t.insertImage})})},"{selectBlogImageButton} click":function(){var n=e("#editor-write_title"),r=t.dock().css("display")==="none";r?(n.addClass("selectingBlogImage"),t.dock().show()):(t.dock().hide(),n.removeClass("selectingBlogImage"))},"{doneBlogImageButton} click":function(){var n=e("#editor-write_title");t.dock().hide(),n.removeClass("selectingBlogImage")},"{removeBlogImageButton} click":function(e){t.image().remove(),t.imageHolder().show(),t.imageData().val(""),e.blur()},insertImage:function(n){var r=t.placeHolder();r.addClass("busy"),r.find("img").remove(),t.imageHolder().hide();var i=e(new Image).addClass("blogImage").css({position:"absolute",opacity:0,left:"-9999px"}).load(function(){var e=t[t.options.resizeUsing](i.width(),i.height(),r.width(),r.height());i.css(e).animate({opacity:1}),r.removeClass("busy")}).appendTo(r).attr("src",n.meta.thumbnail.url);return t.imageData().val(e.toJSON(n.meta)),!1},resizeWithin:function(e,t,n,r){var i=e,s=t,o=n/e;i=e*o,s=t*o;if(s>r){var o=r/t;i=e*o,s=t*o}return{top:(r-s)/2+15,left:(n-i)/2+15,width:i,height:s}},resizeToFill:function(e,t,n,r){var i=e,s=t,o=n/e;i=e*o,s=t*o;if(s<r){var o=r/t;i=e*o,s=t*o}return{top:(r-s)/2,left:(n-i)/2,width:i,height:s}}}}),t.resolve()})});